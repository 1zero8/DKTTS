Debug mode now uses a copy of locals() to prevent RuntimeError
